Protocol_handler_function